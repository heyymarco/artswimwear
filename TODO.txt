move checkoutState to local if guess mode
[high prior] verify the migrated api code in app dir
